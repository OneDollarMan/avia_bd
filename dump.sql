create SCHEMA `avia`;
USE `avia`;
CREATE TABLE `document` ( `id` INT NOT NULL, `name` VARCHAR(45) NOT NULL, PRIMARY KEY (`id`)) ENGINE = InnoDB;
CREATE TABLE `role` ( `id` INT NOT NULL, `name` VARCHAR(45) NOT NULL, PRIMARY KEY (`id`)) ENGINE = InnoDB;
CREATE TABLE `user` ( `id` INT NOT NULL AUTO_INCREMENT, `username` VARCHAR(45) NOT NULL, `password` VARCHAR(45) NOT NULL, `fio` VARCHAR(45) NOT NULL, `document_id` INT NOT NULL, `document_number` INT NOT NULL, `role_id` INT NOT NULL, PRIMARY KEY (`id`), INDEX `fk_user_document_idx` (`document_id` ASC) VISIBLE, INDEX `fk_user_role1_idx` (`role_id` ASC) VISIBLE, CONSTRAINT `fk_user_document` FOREIGN KEY (`document_id`) REFERENCES `document` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION, CONSTRAINT `fk_user_role1` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE = InnoDB;
CREATE TABLE `aircraft` ( `id` INT NOT NULL AUTO_INCREMENT, `name` VARCHAR(45) NOT NULL, `capacity` INT NOT NULL, `plate` INT NOT NULL, PRIMARY KEY (`id`)) ENGINE = InnoDB;
CREATE TABLE `airport` ( `id` INT NOT NULL AUTO_INCREMENT, `name` VARCHAR(45) NOT NULL, `city` VARCHAR(45) NOT NULL, `address` VARCHAR(135) NOT NULL, PRIMARY KEY (`id`)) ENGINE = InnoDB;
CREATE TABLE `route` ( `id` INT NOT NULL AUTO_INCREMENT, `number` VARCHAR(45) NOT NULL, `departure_airport_id` INT NOT NULL, `destination_airport_id` INT NOT NULL, `price` FLOAT NOT NULL, `flight_time` TIME NOT NULL, PRIMARY KEY (`id`), INDEX `fk_flight_airport1_idx` (`departure_airport_id` ASC) VISIBLE, INDEX `fk_flight_airport2_idx` (`destination_airport_id` ASC) VISIBLE, CONSTRAINT `fk_flight_airport1` FOREIGN KEY (`departure_airport_id`) REFERENCES `airport` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION, CONSTRAINT `fk_flight_airport2` FOREIGN KEY (`destination_airport_id`) REFERENCES `airport` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE = InnoDB;
CREATE TABLE `flight` ( `id` INT NOT NULL AUTO_INCREMENT, `route_id` INT NOT NULL, `aircraft_id` INT NOT NULL, `departure_date` DATETIME NOT NULL, PRIMARY KEY (`id`), INDEX `fk_flight_route1_idx` (`route_id` ASC) VISIBLE, INDEX `fk_flight_aircraft1_idx` (`aircraft_id` ASC) VISIBLE, CONSTRAINT `fk_flight_route1` FOREIGN KEY (`route_id`) REFERENCES `route` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION, CONSTRAINT `fk_flight_aircraft1` FOREIGN KEY (`aircraft_id`) REFERENCES `aircraft` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE = InnoDB;
CREATE TABLE `seat` ( `id` INT NOT NULL AUTO_INCREMENT, `flight_id` INT NOT NULL, `user_id` INT NULL, `purchase_date` DATETIME NULL, PRIMARY KEY (`id`), INDEX `fk_seat_user1_idx` (`user_id` ASC) VISIBLE, INDEX `fk_seat_flight1_idx` (`flight_id` ASC) VISIBLE, CONSTRAINT `fk_seat_user1` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION, CONSTRAINT `fk_seat_flight1` FOREIGN KEY (`flight_id`) REFERENCES `flight` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE = InnoDB;
INSERT INTO `role` VALUES (0,'Пассажир'),(1,'Диспетчер'),(2,'Администратор');
INSERT INTO `document` VALUES (0,'Паспорт'),(1,'Загран');
INSERT INTO `user` VALUES (1,'root','63a9f0ea7bb98050796b649e85481845','root','0','0',2);
